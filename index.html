<html>
	<head>
		<title>gas1</title>
		<script type="text/javascript" src="js/three.min.js"></script>
		<script type="text/javascript" src="js/particle.js"></script>
		<script type="text/javascript" src="js/jquery-2.1.0.min.js"></script>

		<style type="text/css">canvas { width: 100%; height: 100%; }</style>
	</head>
	<body>
		<script type="text/javascript" src="js/gasParticle.js"></script>
		<script type="text/javascript">

			function onWindowResize() {	// event handler to deal with fixing things when the window resizes
				camera.aspect = window.innerWidth / window.innerHeight;
				camera.updateProjectionMatrix();

				renderer.setSize( window.innerWidth, window.innerHeight );

			}

			function onDocumentMouseMove( event ) { // ebent hangler to allow the camera to be moved using the mouse

				mouseX = event.clientX - window.innerWidth / 2;
				mouseY = event.clientY - window.innerHeight / 2;

			}

			var render = function () { // rendering loop
				requestAnimationFrame(render); 
				renderer.render(scene, camera);
				
				for (var i = 0; i < numParticles; i++) {
					particles[i].tick();
				}

				// for camera movement
				camera.position.x += ( mouseX - camera.position.x ) * 0.0001;
				camera.position.y += ( - mouseY - camera.position.y ) * 0.0001;

				camera.lookAt(container.mesh.position);
			}; 

			////////////////////////////////////////////////////////////////////////
			////////////////////////////////////////////////////////////////////////

			var mouseY = 0;	// used for the movment wth the mouse
			var mouseX = 0;

			// create bare essentials: scene, camera and renderer
			var scene = new THREE.Scene();
			var camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);

			camera.position.z = 5;

			var renderer = new THREE.WebGLRenderer();
			renderer.setSize(window.innerWidth, window.innerHeight);
			document.body.appendChild(renderer.domElement);

			// create the container box that particles appear to be inside
			var container = {
				geometry: 0,
				material: 0,
				mesh: 0,
				edges: 0
			};

			container.geometry = new THREE.CubeGeometry(4, 4, 4);
			container.material = new THREE.MeshBasicMaterial({color: 0xffffff, transparent: true, opacity: 0.25});
			container.mesh = new THREE.Mesh(container.geometry, container.material);
			container.edges = new THREE.EdgesHelper(container.mesh, 0xffffff);
			container.edges.material.linewidth = 2;
			scene.add(container.edges);
			scene.add(container.mesh);

			// create particles
			var numParticles = 700;
			var particles = [];

			for (var i = 0; i < numParticles; i++) {
				particles[i] = new GasParticle(i, 0, 0, 0);
				scene.add(particles[i].mesh);
			}

			// allow the camera to be moved with the mouse
			document.addEventListener( 'mousemove', onDocumentMouseMove, false );

			// fix everything when we are resized
			window.addEventListener( 'resize', onWindowResize, false );

			render();


		</script>
	</body>
</html>